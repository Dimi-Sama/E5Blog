<!-- 
⣿⣿⣿⡇⠄⣠⣬⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⡝⠙⣿⣷⡄⣹⣿⣿⣿⣿⠛⠛⠛⠛⠋⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠛⠿⠿⠿⠿⠿⠿⠿⠿⠿⠿⠟⠿⡿⠿⠿⠿⠿⠿⠿⠿⢛⡻⡿⠿⣿⣿⣿⣿⣿⣿⣿
⣄⠄⡼⣿⣷⣿⣿⣿⡉⣿⣿⣿⣿⣿⡟⢿⣿⠄⠄⠄⠄⠘⣿⣿⣿⣿⡟⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿
⠄⢱⡓⠉⠙⠙⠛⣻⠃⣿⣿⣿⣿⣿⠇⠸⣿⠄⠄⠄⠄⠄⠸⣿⡻⣿⣿⡘⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⢿⣿⡟⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣿⣿⠟⡿⠿⣿⣿
⡠⠞⢯⣤⣠⣤⣾⣷⠄⣿⣿⣿⣿⣿⠄⠄⢻⠄⠄⠄⠄⠄⠄⠘⢧⠙⠻⣿⣄⠻⣿⣿⣿⣿⡟⣿⣿⣿⣿⠈⢿⣧⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⡇⣷⠋⡾⣇⣀⣸⣿
⣿⡿⣿⣿⢏⡿⠉⠉⠄⣿⣿⣿⣿⣿⠄⠄⠘⠒⠒⠒⠒⠒⠶⠶⠤⠄⠄⠈⠙⠂⠈⠙⠛⠋⠉⠉⠭⠿⠿⠶⠾⠛⠚⠛⠛⠛⠋⣿⣿⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿
⠿⡀⠄⠘⠉⠇⠂⠄⠄⣇⢻⣿⣿⣯⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⣿⣿⣿⣿⣿⡇⣿⣿⣿⣿⣿⣿⣿
⡆⠁⠄⠊⠙⠒⢄⣀⠄⣿⠐⢿⣿⣿⢠⣶⣦⣤⣀⣀⣀⣀⣀⣀⣀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢀⣀⣀⣀⠄⢀⣀⣀⣤⣤⣤⣿⣿⡯⢿⣿⡇⣿⣿⣿⣿⣿⣿⣿
⠄⠄⠄⣀⡀⠄⢈⣿⡆⣻⡇⠄⠛⣿⡆⠄⠉⠉⠙⠛⠛⠋⠉⠁⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠈⠉⠙⠛⠛⠛⠋⠉⠒⢰⣿⣿⡇⠘⣿⡇⣿⣿⣿⣿⣿⣿⣿
⣀⢠⠄⠁⠲⣻⣿⠿⠃⣿⣿⡀⠄⠘⢿⡀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢸⣿⣿⢀⣴⣿⡇⣿⣿⣿⣿⣿⣿⣿
⣿⣷⣀⠄⣀⢟⡩⣲⠄⣿⣿⣿⣤⣀⠈⠻⣄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⣼⣿⣿⣿⣿⣿⡇⣹⣿⣿⣿⣿⣿⣿
⣵⣝⢿⣟⡯⠭⡹⣿⣄⣿⣿⣿⣿⣿⣷⡀⠈⠳⢄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢀⣿⣿⣿⣿⣿⣿⡇⢮⣭⡯⠍⠹⣻⣿
⣿⣿⣿⣿⡛⣫⣴⣿⠌⢹⢿⣿⣿⣿⣿⣿⡄⠄⠄⠈⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢀⣾⣿⣿⣿⣿⣿⣿⡇⣚⠗⠄⠄⣰⣿⣿
⡟⠏⠉⠉⠻⣦⡉⢩⠤⠈⠉⠄⣩⡿⠛⠛⠛⠂⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠛⠛⠛⠛⠛⣛⣛⣛⣃⣿⣷⣶⣿⣿⣿⣿
⣩⠅⠄⠄⢺⠿⠛⢦⣇⢠⠈⣨⣾⣷⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⣀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⣿⣿⣿⣿⣿⣿⣿⣿⣿⣯⣥⣤
⣣⣴⣇⢸⠟⣄⣀⣸⣿⣿⣿⣿⣿⣯⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠺⣿⣦⣄⣀⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⠄⢠⣶⣶⢿⣿⣿⣿⣟⣿⢿⣿⣿⣿⣿⣿⣿ 
-->
<?php
session_start();
include 'lib/dbConnect.php';
$bd = new DbConnect();
$conn = $bd->connect();
?>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="stylesheet" href="styles/main.css">
  <link rel="icon" type="image/x-icon" href="images/logo.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accueil</title>
</head>

<body>
  <div class="background">
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>
    <span></span>

    <?php require_once "lib/navbar.php" ?>


    <div class="container">
      <div class="left-content">
        <h1>Dernières actualités</h1>
        <div class="last-actu">
          <?php

          /**
           * Retrieves the latest article from the database and displays its information.
           */
          $sql = "SELECT * FROM article ORDER BY datePublication DESC LIMIT 1";
          $result = $conn->prepare($sql);
          $result->execute();
          foreach ($result as $last) {
          ?>
            <a href="viewArticles.php?idArticle=<?php echo $last['id'] ?>">
              <div class="last-actu-content">
                <div class="last-actu-image">
                  <img class="imgactu" src="images/<?php echo $last['image']  ?>" alt="">
                </div>
                <div class="last-actu-text">
                  <h2><?php echo $last['titre'] ?></h2>
                  <?php
                  $idCat = $last['idCate'];
                  $sql = "SELECT libelle FROM categorie WHERE id= :id";
                  $req = $conn->prepare($sql);
                  $req->bindParam(':id', $idCat);
                  $req->execute();
                  $cate = $req->fetch(PDO::FETCH_ASSOC);
                  if (isset($cate['id'])) {
                    echo "<p>" . $cate['libelle'] . "</p>";
                    echo "<p>" . $last['datePublication'] . "</p>";
                    echo "<p>" . $last['image'] . "</p>";
                  }


                  ?>
                </div>
              </div>
        </div>
        </a>
      <?php
          }
      ?>





      <div class="text">
        <h1>À voir aussi</h1>
        <br>
      </div>
      <div class="third-content">

        <?php
        /**
         * Displays the last three articles with their title, image and category.
         */

        $sql = "SELECT * FROM article order by datePublication DESC LIMIT 3 OFFSET 1; ";
        $result = $conn->prepare($sql);
        $result->execute();
        foreach ($result as $last) {
        ?>
          <a href="viewArticles.php?idArticle=<?php echo $last['id'] ?>">
            <div class="third-image">
              <img src="images/<?php echo $last['image'] ?>" alt="Image 1">
              <h4><?php echo $last['titre'] ?></h3>
                <?php
                $idCat = $last['idCate'];
                $sql = "SELECT libelle FROM categorie WHERE id= :id";
                $req = $conn->prepare($sql);
                $req->bindParam(':id', $idCat);
                $req->execute();
                $cate = $req->fetch(PDO::FETCH_ASSOC);
                echo "<p>" . $cate['libelle'] . "</p>";
                ?>
          </a>
      </div>

    <?php
        }
    ?>

      </div>

    </div>
    <div class="right-content">

      <h2>Twitch de ChizuSama_</h2>
      <div class="right-image">
        <iframe src="https://player.twitch.tv/?channel=chizusama_&parent=localhost&muted=true" height="240" width="100%" allowfullscreen>
        </iframe>

      </div>

      <div class="right-image">
        <h2>Anime</h2>
        <?php
        /**
         * Executes a SQL query to select a random article from the 'article' table with a specific category ID.
         */

        $sql = "SELECT * FROM `article` WHERE idCate = 2 ORDER BY RAND ( ) LIMIT 1";
        $result = $conn->prepare($sql);
        $result->execute();
        foreach ($result as $last) {
        ?>
          <a href="viewArticles.php?idArticle=<?php echo $last['id'] ?>">
            <img src="images/<?php echo $last['image'] ?>" alt="Image">
            <p><?php echo $last['titre'] ?></p>
          </a>
      </div>
    <?php
        }
    ?>

    <div class="right-image">
      <h2>Gaming</h2>

      <?php
      /**
       * Executes a SQL query to select a random article from the 'article' table with a specific category ID.
       */

      $sql = "SELECT * FROM `article` WHERE idCate = 1 ORDER BY RAND ( ) LIMIT 1";
      $result = $conn->prepare($sql);
      $result->execute();
      foreach ($result as $last) {
      ?>
        <a href="viewArticles.php?idArticle=<?php echo $last['id'] ?>">
          <img src="images/<?php echo $last['image'] ?>" alt="Image">
          <p><?php echo $last['titre'] ?></p>
        </a>
    </div>
  <?php
      }
  ?>


    </div>

  </div>
  </div>



</body>
<script src="js/navbar.js"></script>

</html>